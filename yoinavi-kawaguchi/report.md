# 酔ナビ川口 - 飲み会帰りのセーフルートマップ

## 応募作品タイプ
**アプリケーション**

地域課題の解決に資する目的で作成される実際に利用可能なツール・アプリケーション・サービス

## 作品の主なテーマ
**防犯・防災**

---

## 作品概要

「酔ナビ川口」は、飲み会帰りの夜道を安全に帰宅するためのWebアプリケーションです。埼玉県川口市の犯罪発生データ、防犯カメラ設置位置、PLATEAU建物データ、土地利用データを統合し、4要素安全スコアモデルにより道路ごとの安全度を可視化。時間帯シミュレーション機能で深夜の危険度変化も確認でき、最短ルートと安全優先ルートを比較しながら、周辺のコンビニや交番も把握できます。

---

## 作品本体の説明

### アプリケーションの目的

川口市は埼玉県内でも繁華街が多く、夜間の人通りが多いエリアです。飲み会後の帰宅時、酔った状態では判断力が低下し、普段は避けるような暗い道や人通りの少ない道を通ってしまうリスクがあります。本アプリは、客観的なデータに基づいて安全な帰宅ルートを提案することで、夜間の犯罪被害リスクを軽減することを目的としています。

### 主な機能

#### 1. 4要素安全スコアモデル
道路ごとの安全度を以下の4要素から算出し、50〜100点で評価します：

| 要素 | 重み | 説明 |
|------|------|------|
| 犯罪リスク | 50% | カーネル密度推定による犯罪発生リスク |
| 防犯カメラ | - | 犯罪リスクを最大50%軽減（乗算モデル） |
| 見通し/影 | 20% | 建物による死角・暗さの影響 |
| 土地利用 | 30% | 商業地・住宅地など周辺環境による人通り推定 |

```
有効犯罪リスク = 犯罪リスク × (1 - カメラ保護率)
安全スコア = 0.50×(1-有効犯罪リスク) + 0.20×(1-影響度) + 0.30×土地利用スコア
```

#### 2. 時間帯シミュレーション
スライダーで時間帯を変更し、安全度の変化をリアルタイムで確認できます：
- **日中（7-17時）**: 見通し良好、基準スコア
- **夕方（17-20時）**: やや減点
- **夜間（20-24時）**: カメラ効果1.2倍、影響度2倍
- **深夜（0-5時）**: カメラ効果2倍、影響度3倍、全体0.5倍補正

#### 3. ルート検索・比較
出発地と目的地を指定すると、2種類のルートを提案：
- **安全優先ルート**（紫色）: 安全スコアを重視した経路
- **最短ルート**（オレンジ色）: 距離最小化経路

各ルートの所要時間、距離、平均安全スコアを比較表示します。

#### 4. 3D建物表示
PLATEAU CityGMLデータを活用し、建物を3D表示。用途別に色分けすることで、周辺環境を直感的に把握できます：
- 緑: 商業施設
- 青: 住宅
- ピンク: 業務施設
- 紫: 公共施設

#### 5. 周辺施設表示
ルート周辺の安全スポットをマーカー表示：
- コンビニ（24時間営業の有無も表示）
- 交番
- 公衆トイレ
- 駅
- 防犯カメラ

### 使い方

1. **現在地を取得**: 「現在地を取得」ボタンをクリック、または地図上をクリック
2. **目的地を設定**: 検索ボックスで駅名を入力、または地図上をクリック
3. **ルートを比較**: 安全優先ルートと最短ルートの安全スコア・距離・時間を比較
4. **時間帯を変更**: スライダーで帰宅予定時刻に合わせて安全度を確認
5. **周辺施設をチェック**: コンビニ・交番の位置を確認し、必要に応じて立ち寄り計画

---

## データセット名・自治体名

| データセット | 提供者 | 件数・規模 |
|-------------|--------|-----------|
| 川口市犯罪発生データ | 埼玉県警察 | 1,823件（手口別・位置情報付き） |
| 西川口地区防犯カメラ設置位置 | 川口市 | 65台 |
| 三次元都市モデル（建物） | 国土交通省 PLATEAU 川口市 2024 | 54,634棟 |
| 三次元都市モデル（土地利用） | 国土交通省 PLATEAU 川口市 2024 | 12,681区画 |
| 道路ネットワーク | OpenStreetMap | 約8,000セグメント |
| POI（コンビニ・交番等） | OpenStreetMap | 約150件 |
| 地図タイル | CARTO / OpenStreetMap | - |

---

## 評価ポイントの説明

### 作品の実用度

本アプリは、実際の犯罪発生データと防犯カメラ位置を組み合わせた**エビデンスベースの安全評価**を提供します。従来の「明るい道を選ぶ」という主観的判断を、1,823件の犯罪データと65台のカメラ位置データに基づく客観的スコアに置き換えました。時間帯シミュレーション機能により、深夜0時と夕方18時では安全度が大きく異なることを可視化。飲み会の終了時刻に合わせた現実的なルート選択が可能です。Webアプリとしてスマートフォンからアクセスでき、インストール不要で即座に利用できます。

### 作品の完成度

**データ統合**: 6種類のデータソースを統合し、54,634棟の建物データ、12,681区画の土地利用データ、1,823件の犯罪データを処理。**アルゴリズム実装**: カーネル密度推定、ダイクストラ法によるルート探索、分位点正規化など、学術的に裏付けのある手法を実装。**UI/UX**: MapLibre GL JSによる滑らかな地図操作、deck.glによる3D建物表示、レスポンシブデザインによるモバイル対応を実現。ルート計算は2秒以内、地図描画は60FPSを維持し、実用的なパフォーマンスを達成しています。

### 作品の挑戦度

**新規性**: 防犯カメラを「独立した安全要素」ではなく「犯罪リスク軽減要素」として乗算モデルで組み込んだ点が独自。カメラが多い場所＝元々危険な場所という現実を反映し、カメラによる最大50%のリスク軽減効果を数理モデル化しました。**データ融合**: PLATEAUの建物高さデータを「見通しの悪さ」指標に変換し、土地利用コードを「人通りの多さ」に変換するなど、元データにない価値を創出。**技術スタック**: Next.js 14、TypeScript、MapLibre GL JS、deck.glを組み合わせたモダンなWebGISアーキテクチャを採用し、3D表示と高速なルート計算を両立しました。

---

## 技術仕様

### フロントエンド
- **フレームワーク**: Next.js 14 (App Router)
- **言語**: TypeScript
- **地図ライブラリ**: MapLibre GL JS
- **3D描画**: deck.gl (PolygonLayer)
- **状態管理**: Zustand
- **スタイリング**: Tailwind CSS

### データ処理
- **犯罪リスク計算**: カーネル密度推定（ガウシアンカーネル、バンド幅150m）
- **カメラ効果計算**: 指数減衰モデル（有効半径80m、減衰定数30m）
- **ルート探索**: ダイクストラ法（距離/安全スコア重み付け）
- **正規化**: 分位点正規化（5%/95%パーセンタイル）

### ファイル構成
```
yoinavi-kawaguchi/
├── src/
│   ├── app/
│   │   ├── page.tsx          # メインページ
│   │   └── layout.tsx        # レイアウト
│   ├── components/
│   │   ├── Map/MapView.tsx   # 地図コンポーネント
│   │   ├── UI/               # UIコンポーネント
│   │   ├── Search/           # 検索機能
│   │   └── RouteInfo/        # ルート情報
│   ├── lib/
│   │   ├── safety-score.ts   # 安全スコア計算
│   │   └── routing.ts        # ルート探索
│   ├── stores/
│   │   └── mapStore.ts       # 状態管理
│   └── types/
│       └── index.ts          # 型定義
├── public/data/              # 処理済みデータ
├── scripts/                  # データ処理スクリプト
└── package.json
```

---

## 今後の展望

1. **データ更新の自動化**: 犯罪データの定期更新パイプライン構築
2. **エリア拡大**: 川口市全域、および周辺自治体への展開
3. **ユーザーフィードバック**: 実際に歩いた際の「体感安全度」収集機能
4. **リアルタイム情報**: 天候・イベント情報との連携による動的スコア調整
5. **多言語対応**: 外国人居住者向けの英語・中国語対応

---

## ライセンス・クレジット

- 犯罪データ: 埼玉県警察「犯罪オープンデータ」
- 防犯カメラデータ: 川口市
- PLATEAU: 国土交通省 Project PLATEAU（CC BY 4.0）
- 道路・POIデータ: OpenStreetMap contributors（ODbL）
- 地図タイル: CARTO（CC BY 3.0）

---

## 連絡先

[作成者情報を記入]
